{"version":3,"sources":["webpack://MIDI/webpack/universalModuleDefinition","webpack://MIDI/webpack/bootstrap","webpack://MIDI/(webpack)/buildin/harmony-module.js","webpack://MIDI/./src/gm.js","webpack://MIDI/./src/index.js","webpack://MIDI/./src/jasmid/_stream.js","webpack://MIDI/./src/jasmid/index.js","webpack://MIDI/./src/jasmid/midifile.js","webpack://MIDI/./src/jasmid/replayer.js","webpack://MIDI/./src/loader.js","webpack://MIDI/./src/player.js","webpack://MIDI/./src/plugins/audiotag.js","webpack://MIDI/./src/plugins/index.js","webpack://MIDI/./src/plugins/webaudio.js","webpack://MIDI/./src/plugins/webmidi.js","webpack://MIDI/./src/root.js","webpack://MIDI/./src/utils/audio-detect.js","webpack://MIDI/./src/utils/index.js","webpack://MIDI/./src/utils/load-script.js","webpack://MIDI/./src/utils/request.js"],"names":["root","GM","map","clean","name","replace","toLowerCase","res","byName","byId","byCategory","key","list","n","length","instrument","num","parseInt","substr","indexOf","id","number","category","Piano","Organ","Guitar","Bass","Strings","Ensemble","Brass","Reed","Pipe","Ethnic","Percussive","getInstrument","channelId","channel","channels","setInstrument","program","delay","setTimeout","getMono","mono","setMono","truthy","getOmni","omni","setOmni","getSolo","solo","setSolo","i","pitchBend","mute","keyToNote","noteToKey","A0","C8","number2key","octave","window","MIDI","module","exports","str","position","read","result","readInt32","charCodeAt","readInt16","readInt8","signed","eof","readVarInt","b","MidiFile","data","lastEventTypeByte","readChunk","stream","readEvent","event","deltaTime","eventTypeByte","type","subtypeByte","subtype","Error","text","microsecondsPerBeat","hourByte","frameRate","hour","min","sec","frame","subframe","numerator","denominator","Math","pow","metronome","thirtyseconds","scale","param1","eventType","noteNumber","velocity","amount","controllerType","value","programNumber","Stream","headerChunk","headerStream","formatType","trackCount","timeDivision","ticksPerBeat","header","tracks","trackChunk","trackStream","push","clone","o","ret","Replayer","midiFile","timeWarp","eventProcessor","bpm","trackStates","beatsPerMinute","bpmOverride","nextEventIndex","ticksToNextEvent","getNextEvent","nextEventTrack","nextEvent","ticksToEvent","track","midiEvent","temporal","processEvents","processNext","beatsToGenerate","secondsToGenerate","time","getData","Soundfont","DEBUG","USE_XHR","soundfontUrl","loadPlugin","opts","onsuccess","audioDetect","supports","hash","location","api","webmidi","AudioContext","Audio","connect","audioFormat","targetFormat","__api","__audioFormat","loadResource","instruments","format","WebMIDI","audiotag","requestQueue","webaudio","context","onprogress","onerror","pending","waitForEnd","instrumentId","sendRequest","evt","progress","fileProgress","queueProgress","soundfontPath","request","url","responseText","script","document","createElement","language","body","appendChild","loadScript","add","verify","setDefaultPlugin","midi","Player","player","currentTime","endTime","restart","playing","startDelay","BPM","start","resume","startAudio","pause","tmp","stopAudio","stop","addListener","onMidiEvent","removeListener","undefined","clearAnimation","animationFrameId","cancelAnimationFrame","setAnimation","callback","tOurTime","tTheirTime","requestAnimationFrame","Date","now","total","minutes","seconds","t1","t2","end","events","noteRegistrar","loadMidiFile","replayer","currentData","getLength","console","error","loadFile","file","atob","split","fetch","XMLHttpRequest","open","overrideMimeType","onreadystatechange","readyState","status","t","ff","mx","scc","String","fromCharCode","z","join","send","getFileInstruments","programs","gm","isFinite","eventQueue","queuedTime","startTime","scheduleTracking","note","offset","message","shift","getContext","WebAudio","ctx","totalTime","__now","getNow","performance","fromCache","messages","foffset","obj","queueTime","setController","programChange","MIDIOffset","source","noteOn","interval","noteOff","pop","clearInterval","clearTimeout","disconnect","AudioTag","volume","bufferNid","audioBuffers","notesOn","notes","nid","playChannel","instrumentNoteId","audio","log","src","play","stopChannel","len","cId","setVolume","chordOn","chord","idx","chordOff","stopAllNotes","base64ToArrayBuffer","base64","binaryString","bytes","Uint8Array","buffer","useStreamingBuffer","sources","effects","masterVolume","noteId","bufferId","createMediaElementSource","createBufferSource","chain","input","gain","destination","playbackRate","gainNode","createGain","max","linearRampToValueAtTime","sid","setEffects","tunajs","effect","setContext","createAudioContext","newCtx","onload","Tuna","urls","bufferPending","requestAudio","soundfont","index","loadAudio","isLoaded","err","synth","controls","autoplay","preload","addEventListener","decodeAudioData","responseType","response","webkitAudioContext","plugin","output","cancel","errFunction","navigator","requestMIDIAccess","then","access","pluginOutputs","outputs","canPlayThrough","mime","setAttribute","removeChild","isNative","Function","prototype","toString","call","plugins","canPlayType","vorbis","mpeg","getTime","setInterval","maxExecution","_globalExists","path","parts","object","e","LoadScript","loaded","loading","config","that","doc","getElementsByTagName","testElement","element","test","getNext","hasError","batchTest","addElement","removeTest","onLoad","istrue","strictOrder","ID","method","headers","withCredentials","xhr","setRequestHeader","upload","totalBytes","lengthComputable","rawBytes","getResponseHeader","target","responseXML","JSON","parse"],"mappings":"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","file":"midi.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"MIDI\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MIDI\"] = factory();\n\telse\n\t\troot[\"MIDI\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","/*\n * ----------------------------------------------------------\n * GeneralMIDI\n * ----------------------------------------------------------\n */\n\nimport root from './root';\n\nroot.GM = (function (map) {\n  const clean = function (name) {\n    return name\n      .replace(/[^a-z0-9 ]/gi, '')\n      .replace(/[ ]/g, '_')\n      .toLowerCase();\n  };\n  const res = {\n    byName: {},\n    byId: {},\n    byCategory: {},\n  };\n  for (const key in map) {\n    const list = map[key];\n    for (let n = 0, { length } = list; n < length; n++) {\n      let instrument = list[n];\n      if (!instrument) continue;\n      let num = parseInt(instrument.substr(0, instrument.indexOf(' ')), 10);\n      instrument = instrument.replace(`${num} `, '');\n      res.byId[--num] = res.byName[clean(instrument)] = res.byCategory[\n        clean(key)\n      ] = {\n        id: clean(instrument),\n        instrument,\n        number: num,\n        category: key,\n      };\n    }\n  }\n  return res;\n})({\n  Piano: [\n    '1 Acoustic Grand Piano',\n    '2 Bright Acoustic Piano',\n    '3 Electric Grand Piano',\n    '4 Honky-tonk Piano',\n    '5 Electric Piano 1',\n    '6 Electric Piano 2',\n    '7 Harpsichord',\n    '8 Clavinet',\n  ],\n  'Chromatic Percussion': [\n    '9 Celesta',\n    '10 Glockenspiel',\n    '11 Music Box',\n    '12 Vibraphone',\n    '13 Marimba',\n    '14 Xylophone',\n    '15 Tubular Bells',\n    '16 Dulcimer',\n  ],\n  Organ: [\n    '17 Drawbar Organ',\n    '18 Percussive Organ',\n    '19 Rock Organ',\n    '20 Church Organ',\n    '21 Reed Organ',\n    '22 Accordion',\n    '23 Harmonica',\n    '24 Tango Accordion',\n  ],\n  Guitar: [\n    '25 Acoustic Guitar (nylon)',\n    '26 Acoustic Guitar (steel)',\n    '27 Electric Guitar (jazz)',\n    '28 Electric Guitar (clean)',\n    '29 Electric Guitar (muted)',\n    '30 Overdriven Guitar',\n    '31 Distortion Guitar',\n    '32 Guitar Harmonics',\n  ],\n  Bass: [\n    '33 Acoustic Bass',\n    '34 Electric Bass (finger)',\n    '35 Electric Bass (pick)',\n    '36 Fretless Bass',\n    '37 Slap Bass 1',\n    '38 Slap Bass 2',\n    '39 Synth Bass 1',\n    '40 Synth Bass 2',\n  ],\n  Strings: [\n    '41 Violin',\n    '42 Viola',\n    '43 Cello',\n    '44 Contrabass',\n    '45 Tremolo Strings',\n    '46 Pizzicato Strings',\n    '47 Orchestral Harp',\n    '48 Timpani',\n  ],\n  Ensemble: [\n    '49 String Ensemble 1',\n    '50 String Ensemble 2',\n    '51 Synth Strings 1',\n    '52 Synth Strings 2',\n    '53 Choir Aahs',\n    '54 Voice Oohs',\n    '55 Synth Choir',\n    '56 Orchestra Hit',\n  ],\n  Brass: [\n    '57 Trumpet',\n    '58 Trombone',\n    '59 Tuba',\n    '60 Muted Trumpet',\n    '61 French Horn',\n    '62 Brass Section',\n    '63 Synth Brass 1',\n    '64 Synth Brass 2',\n  ],\n  Reed: [\n    '65 Soprano Sax',\n    '66 Alto Sax',\n    '67 Tenor Sax',\n    '68 Baritone Sax',\n    '69 Oboe',\n    '70 English Horn',\n    '71 Bassoon',\n    '72 Clarinet',\n  ],\n  Pipe: [\n    '73 Piccolo',\n    '74 Flute',\n    '75 Recorder',\n    '76 Pan Flute',\n    '77 Blown Bottle',\n    '78 Shakuhachi',\n    '79 Whistle',\n    '80 Ocarina',\n  ],\n  'Synth Lead': [\n    '81 Lead 1 (square)',\n    '82 Lead 2 (sawtooth)',\n    '83 Lead 3 (calliope)',\n    '84 Lead 4 (chiff)',\n    '85 Lead 5 (charang)',\n    '86 Lead 6 (voice)',\n    '87 Lead 7 (fifths)',\n    '88 Lead 8 (bass + lead)',\n  ],\n  'Synth Pad': [\n    '89 Pad 1 (new age)',\n    '90 Pad 2 (warm)',\n    '91 Pad 3 (polysynth)',\n    '92 Pad 4 (choir)',\n    '93 Pad 5 (bowed)',\n    '94 Pad 6 (metallic)',\n    '95 Pad 7 (halo)',\n    '96 Pad 8 (sweep)',\n  ],\n  'Synth Effects': [\n    '97 FX 1 (rain)',\n    '98 FX 2 (soundtrack)',\n    '99 FX 3 (crystal)',\n    '100 FX 4 (atmosphere)',\n    '101 FX 5 (brightness)',\n    '102 FX 6 (goblins)',\n    '103 FX 7 (echoes)',\n    '104 FX 8 (sci-fi)',\n  ],\n  Ethnic: [\n    '105 Sitar',\n    '106 Banjo',\n    '107 Shamisen',\n    '108 Koto',\n    '109 Kalimba',\n    '110 Bagpipe',\n    '111 Fiddle',\n    '112 Shanai',\n  ],\n  Percussive: [\n    '113 Tinkle Bell',\n    '114 Agogo',\n    '115 Steel Drums',\n    '116 Woodblock',\n    '117 Taiko Drum',\n    '118 Melodic Tom',\n    '119 Synth Drum',\n  ],\n  'Sound effects': [\n    '120 Reverse Cymbal',\n    '121 Guitar Fret Noise',\n    '122 Breath Noise',\n    '123 Seashore',\n    '124 Bird Tweet',\n    '125 Telephone Ring',\n    '126 Helicopter',\n    '127 Applause',\n    '128 Gunshot',\n  ],\n});\n\n/*\n * get/setInstrument\n * ---------------------------------------------------\n */\nroot.getInstrument = function (channelId) {\n  const channel = root.channels[channelId];\n  return channel && channel.instrument;\n};\n\nroot.setInstrument = function (channelId, program, delay) {\n  const channel = root.channels[channelId];\n  if (delay) {\n    return setTimeout(function () {\n      channel.instrument = program;\n    }, delay);\n  }\n  channel.instrument = program;\n};\n\n/*\n * get/setMono\n * ---------------------------------------------------\n */\nroot.getMono = function (channelId) {\n  const channel = root.channels[channelId];\n  return channel && channel.mono;\n};\n\nroot.setMono = function (channelId, truthy, delay) {\n  const channel = root.channels[channelId];\n  if (delay) {\n    return setTimeout(function () {\n      channel.mono = truthy;\n    }, delay);\n  }\n  channel.mono = truthy;\n};\n\n/*\n * get/setOmni\n * ---------------------------------------------------\n */\nroot.getOmni = function (channelId) {\n  const channel = root.channels[channelId];\n  return channel && channel.omni;\n};\n\nroot.setOmni = function (channelId, truthy, delay) {\n  const channel = root.channels[channelId];\n  if (delay) {\n    return setTimeout(function () {\n      channel.omni = truthy;\n    }, delay);\n  }\n  channel.omni = truthy;\n};\n\n/*\n * get/setSolo\n * ---------------------------------------------------\n */\nroot.getSolo = function (channelId) {\n  const channel = root.channels[channelId];\n  return channel && channel.solo;\n};\n\nroot.setSolo = function (channelId, truthy, delay) {\n  const channel = root.channels[channelId];\n  if (delay) {\n    return setTimeout(function () {\n      channel.solo = truthy;\n    }, delay);\n  }\n  channel.solo = truthy;\n};\n\n/*\n * channels\n * ---------------------------------------------------\n */\nroot.channels = (function () {\n  // 0 - 15 channels\n  const channels = {};\n  for (let i = 0; i < 16; i++) {\n    channels[i] = {\n      // default values\n      instrument: i,\n      pitchBend: 0,\n      mute: false,\n      mono: false,\n      omni: false,\n      solo: false,\n    };\n  }\n  return channels;\n})();\n\n/*\n * note conversions\n * ---------------------------------------------------\n */\nroot.keyToNote = {}; // C8  == 108\nroot.noteToKey = {}; // 108 ==  C8\n\n~(function () {\n  const A0 = 0x15; // first note\n  const C8 = 0x6c; // last note\n  const number2key = [\n    'C',\n    'Db',\n    'D',\n    'Eb',\n    'E',\n    'F',\n    'Gb',\n    'G',\n    'Ab',\n    'A',\n    'Bb',\n    'B',\n  ];\n  for (let n = A0; n <= C8; n++) {\n    const octave = ((n - 12) / 12) >> 0;\n    const name = number2key[n % 12] + octave;\n    root.keyToNote[name] = n;\n    root.noteToKey[n] = name;\n  }\n})();\n","import root from './root';\nimport './loader';\nimport './gm';\nimport './player';\nimport './plugins';\n\nwindow.MIDI = root;\nmodule.exports = root;\n","/* Wrapper for accessing strings through sequential reads */\nexport default function (str) {\n  let position = 0;\n\n  function read(length) {\n    const result = str.substr(position, length);\n    position += length;\n    return result;\n  }\n\n  /* read a big-endian 32-bit integer */\n  function readInt32() {\n    const result =\n      (str.charCodeAt(position) << 24) +\n      (str.charCodeAt(position + 1) << 16) +\n      (str.charCodeAt(position + 2) << 8) +\n      str.charCodeAt(position + 3);\n    position += 4;\n    return result;\n  }\n\n  /* read a big-endian 16-bit integer */\n  function readInt16() {\n    const result =\n      (str.charCodeAt(position) << 8) + str.charCodeAt(position + 1);\n    position += 2;\n    return result;\n  }\n\n  /* read an 8-bit integer */\n  function readInt8(signed) {\n    let result = str.charCodeAt(position);\n    if (signed && result > 127) result -= 256;\n    position += 1;\n    return result;\n  }\n\n  function eof() {\n    return position >= str.length;\n  }\n\n  /*\n   * read a MIDI-style variable-length integer\n   * (big-endian value in groups of 7 bits,\n   * with top bit set to signify that another byte follows)\n   */\n  function readVarInt() {\n    let result = 0;\n    while (true) {\n      const b = readInt8();\n      if (b & 0x80) {\n        result += b & 0x7f;\n        result <<= 7;\n      } else {\n        /* b is the last byte */\n        return result + b;\n      }\n    }\n  }\n\n  return {\n    eof,\n    read,\n    readInt32,\n    readInt16,\n    readInt8,\n    readVarInt,\n  };\n}\n","export * from './midifile';\nexport * from './replayer';\n","/**\n * class to parse the .mid file format\n * (depends on _stream.js)\n */\n\nimport Stream from './_stream';\n\nexport function MidiFile(data) {\n  let lastEventTypeByte;\n\n  function readChunk(stream) {\n    const id = stream.read(4);\n    const length = stream.readInt32();\n    return {\n      id,\n      length,\n      data: stream.read(length),\n    };\n  }\n\n  function readEvent(stream) {\n    const event = {};\n    event.deltaTime = stream.readVarInt();\n    let eventTypeByte = stream.readInt8();\n    if ((eventTypeByte & 0xf0) === 0xf0) {\n      /* system / meta event */\n      if (eventTypeByte === 0xff) {\n        /* meta event */\n        event.type = 'meta';\n        const subtypeByte = stream.readInt8();\n        const length = stream.readVarInt();\n        switch (subtypeByte) {\n          case 0x00:\n            event.subtype = 'sequenceNumber';\n            if (length !== 2)\n              throw new Error(\n                `Expected length for sequenceNumber event is 2, got ${length}`\n              );\n            event.number = stream.readInt16();\n            return event;\n          case 0x01:\n            event.subtype = 'text';\n            event.text = stream.read(length);\n            return event;\n          case 0x02:\n            event.subtype = 'copyrightNotice';\n            event.text = stream.read(length);\n            return event;\n          case 0x03:\n            event.subtype = 'trackName';\n            event.text = stream.read(length);\n            return event;\n          case 0x04:\n            event.subtype = 'instrumentName';\n            event.text = stream.read(length);\n            return event;\n          case 0x05:\n            event.subtype = 'lyrics';\n            event.text = stream.read(length);\n            return event;\n          case 0x06:\n            event.subtype = 'marker';\n            event.text = stream.read(length);\n            return event;\n          case 0x07:\n            event.subtype = 'cuePoint';\n            event.text = stream.read(length);\n            return event;\n          case 0x20:\n            event.subtype = 'midiChannelPrefix';\n            if (length !== 1)\n              throw new Error(\n                `Expected length for midiChannelPrefix event is 1, got ${length}`\n              );\n            event.channel = stream.readInt8();\n            return event;\n          case 0x2f:\n            event.subtype = 'endOfTrack';\n            if (length !== 0)\n              throw new Error(\n                `Expected length for endOfTrack event is 0, got ${length}`\n              );\n            return event;\n          case 0x51:\n            event.subtype = 'setTempo';\n            if (length !== 3)\n              throw new Error(\n                `Expected length for setTempo event is 3, got ${length}`\n              );\n            event.microsecondsPerBeat =\n              (stream.readInt8() << 16) +\n              (stream.readInt8() << 8) +\n              stream.readInt8();\n            return event;\n          case 0x54:\n            event.subtype = 'smpteOffset';\n            if (length !== 5)\n              throw new Error(\n                `Expected length for smpteOffset event is 5, got ${length}`\n              );\n            var hourByte = stream.readInt8();\n            event.frameRate = {\n              0x00: 24,\n              0x20: 25,\n              0x40: 29,\n              0x60: 30,\n            }[hourByte & 0x60];\n            event.hour = hourByte & 0x1f;\n            event.min = stream.readInt8();\n            event.sec = stream.readInt8();\n            event.frame = stream.readInt8();\n            event.subframe = stream.readInt8();\n            return event;\n          case 0x58:\n            event.subtype = 'timeSignature';\n            if (length !== 4)\n              throw new Error(\n                `Expected length for timeSignature event is 4, got ${length}`\n              );\n            event.numerator = stream.readInt8();\n            event.denominator = Math.pow(2, stream.readInt8());\n            event.metronome = stream.readInt8();\n            event.thirtyseconds = stream.readInt8();\n            return event;\n          case 0x59:\n            event.subtype = 'keySignature';\n            if (length !== 2)\n              throw new Error(\n                `Expected length for keySignature event is 2, got ${length}`\n              );\n            event.key = stream.readInt8(true);\n            event.scale = stream.readInt8();\n            return event;\n          case 0x7f:\n            event.subtype = 'sequencerSpecific';\n            event.data = stream.read(length);\n            return event;\n          default:\n            // console.log(\"Unrecognised meta event subtype: \" + subtypeByte)\n            event.subtype = 'unknown';\n            event.data = stream.read(length);\n            return event;\n        }\n        /*\n         * event.data = stream.read(length)\n         * return event\n         */\n      } else if (eventTypeByte === 0xf0) {\n        event.type = 'sysEx';\n        const length = stream.readVarInt();\n        event.data = stream.read(length);\n        return event;\n      } else if (eventTypeByte === 0xf7) {\n        event.type = 'dividedSysEx';\n        const length = stream.readVarInt();\n        event.data = stream.read(length);\n        return event;\n      } else {\n        throw new Error(`Unrecognised MIDI event type byte: ${eventTypeByte}`);\n      }\n    } else {\n      /* channel event */\n      let param1;\n      if ((eventTypeByte & 0x80) === 0) {\n        /*\n         * running status - reuse lastEventTypeByte as the event type.\n         * eventTypeByte is actually the first parameter\n         */\n        param1 = eventTypeByte;\n        eventTypeByte = lastEventTypeByte;\n      } else {\n        param1 = stream.readInt8();\n        lastEventTypeByte = eventTypeByte;\n      }\n      const eventType = eventTypeByte >> 4;\n      event.channel = eventTypeByte & 0x0f;\n      event.type = 'channel';\n      switch (eventType) {\n        case 0x08:\n          event.subtype = 'noteOff';\n          event.noteNumber = param1;\n          event.velocity = stream.readInt8();\n          return event;\n        case 0x09:\n          event.noteNumber = param1;\n          event.velocity = stream.readInt8();\n          if (event.velocity === 0) {\n            event.subtype = 'noteOff';\n          } else {\n            event.subtype = 'noteOn';\n          }\n          return event;\n        case 0x0a:\n          event.subtype = 'noteAftertouch';\n          event.noteNumber = param1;\n          event.amount = stream.readInt8();\n          return event;\n        case 0x0b:\n          event.subtype = 'controller';\n          event.controllerType = param1;\n          event.value = stream.readInt8();\n          return event;\n        case 0x0c:\n          event.subtype = 'programChange';\n          event.programNumber = param1;\n          return event;\n        case 0x0d:\n          event.subtype = 'channelAftertouch';\n          event.amount = param1;\n          return event;\n        case 0x0e:\n          event.subtype = 'pitchBend';\n          event.value = param1 + (stream.readInt8() << 7);\n          return event;\n        default:\n          throw new Error(`Unrecognised MIDI event type: ${eventType}`);\n        /*\n         *console.log(\"Unrecognised MIDI event type: \" + eventType)\n         *stream.readInt8()\n         *event.subtype = 'unknown'\n         *return event\n         */\n      }\n    }\n  }\n\n  const stream = Stream(data);\n  const headerChunk = readChunk(stream);\n  if (headerChunk.id !== 'MThd' || headerChunk.length !== 6) {\n    throw new Error('Bad .mid file - header not found');\n  }\n  const headerStream = Stream(headerChunk.data);\n  const formatType = headerStream.readInt16();\n  const trackCount = headerStream.readInt16();\n  const timeDivision = headerStream.readInt16();\n  let ticksPerBeat;\n\n  if (timeDivision & 0x8000) {\n    throw new Error(\n      'Expressing time division in SMTPE frames is not supported yet'\n    );\n  } else {\n    ticksPerBeat = timeDivision;\n  }\n\n  const header = {\n    formatType,\n    trackCount,\n    ticksPerBeat,\n  };\n  const tracks = [];\n  for (let i = 0; i < header.trackCount; i++) {\n    tracks[i] = [];\n    const trackChunk = readChunk(stream);\n    if (trackChunk.id !== 'MTrk') {\n      throw new Error(`Unexpected chunk - expected MTrk, got ${trackChunk.id}`);\n    }\n    const trackStream = Stream(trackChunk.data);\n    while (!trackStream.eof()) {\n      const event = readEvent(trackStream);\n      tracks[i].push(event);\n      // console.log(event)\n    }\n  }\n\n  return {\n    header,\n    tracks,\n  };\n}\n","const clone = function (o) {\n  if (typeof o !== 'object') return o;\n  if (o === null) return o;\n  const ret = typeof o.length === 'number' ? [] : {};\n  for (const key in o) ret[key] = clone(o[key]);\n  return ret;\n};\n\nexport function Replayer(midiFile, timeWarp, eventProcessor, bpm) {\n  const trackStates = [];\n  let beatsPerMinute = bpm || 120;\n  const bpmOverride = !!bpm;\n  const { ticksPerBeat } = midiFile.header;\n\n  for (let i = 0; i < midiFile.tracks.length; i++) {\n    trackStates[i] = {\n      nextEventIndex: 0,\n      ticksToNextEvent: midiFile.tracks[i].length\n        ? midiFile.tracks[i][0].deltaTime\n        : null,\n    };\n  }\n\n  function getNextEvent() {\n    let ticksToNextEvent = null;\n    let nextEventTrack = null;\n    let nextEventIndex = null;\n\n    for (let i = 0; i < trackStates.length; i++) {\n      if (\n        trackStates[i].ticksToNextEvent != null &&\n        (ticksToNextEvent == null ||\n          trackStates[i].ticksToNextEvent < ticksToNextEvent)\n      ) {\n        ticksToNextEvent = trackStates[i].ticksToNextEvent;\n        nextEventTrack = i;\n        nextEventIndex = trackStates[i].nextEventIndex;\n      }\n    }\n    if (nextEventTrack != null) {\n      /* consume event from that track */\n      const nextEvent = midiFile.tracks[nextEventTrack][nextEventIndex];\n      if (midiFile.tracks[nextEventTrack][nextEventIndex + 1]) {\n        trackStates[nextEventTrack].ticksToNextEvent +=\n          midiFile.tracks[nextEventTrack][nextEventIndex + 1].deltaTime;\n      } else {\n        trackStates[nextEventTrack].ticksToNextEvent = null;\n      }\n      trackStates[nextEventTrack].nextEventIndex += 1;\n      /* advance timings on all tracks by ticksToNextEvent */\n      for (let i = 0; i < trackStates.length; i++) {\n        if (trackStates[i].ticksToNextEvent != null) {\n          trackStates[i].ticksToNextEvent -= ticksToNextEvent;\n        }\n      }\n      return {\n        ticksToEvent: ticksToNextEvent,\n        event: nextEvent,\n        track: nextEventTrack,\n      };\n    }\n    return null;\n  }\n  //\n  let midiEvent;\n  const temporal = [];\n  ~(function processEvents() {\n    function processNext() {\n      if (\n        !bpmOverride &&\n        midiEvent.event.type === 'meta' &&\n        midiEvent.event.subtype === 'setTempo'\n      ) {\n        // tempo change events can occur anywhere in the middle and affect events that follow\n        beatsPerMinute = 60000000 / midiEvent.event.microsecondsPerBeat;\n      }\n      // /\n      let beatsToGenerate = 0;\n      let secondsToGenerate = 0;\n      if (midiEvent.ticksToEvent > 0) {\n        beatsToGenerate = midiEvent.ticksToEvent / ticksPerBeat;\n        secondsToGenerate = beatsToGenerate / (beatsPerMinute / 60);\n      }\n      // /\n      const time = secondsToGenerate * 1000 * timeWarp || 0;\n      temporal.push([midiEvent, time]);\n      midiEvent = getNextEvent();\n    }\n    // /\n    midiEvent = getNextEvent();\n    if (midiEvent) {\n      while (midiEvent) processNext(true);\n    }\n  })();\n\n  return {\n    getData() {\n      return clone(temporal);\n    },\n  };\n}\n","/*\n * ----------------------------------------------------------\n * root.Plugin : 0.3.4 : 2015-03-26\n * ----------------------------------------------------------\n * https://github.com/mudcube/root.js\n * ----------------------------------------------------------\n * Inspired by javax.sound.midi (albeit a super simple version):\n *   http://docs.oracle.com/javase/6/docs/api/javax/sound/midi/package-summary.html\n * ----------------------------------------------------------\n * Technologies\n * ----------------------------------------------------------\n *  Web MIDI API - no native support yet (jazzplugin)\n *  Web Audio API - firefox 25+, chrome 10+, safari 6+, opera 15+\n *  HTML5 Audio Tag - ie 9+, firefox 3.5+, chrome 4+, safari 4+, opera 9.5+, ios 4+, android 2.3+\n * ----------------------------------------------------------\n */\n\nimport root from './root';\nimport { audioDetect, loadScript, request } from './utils';\n\nroot.Soundfont = {};\nroot.DEBUG = true;\nroot.USE_XHR = true;\nroot.soundfontUrl = './soundfont/';\n\n/*\n * root.loadPlugin({\n *   onsuccess: function() { },\n *   onprogress: function(state, percent) { },\n *   targetFormat: 'mp3', // optionally can force to use MP3 (for instance on mobile networks)\n *   instrument: 'acoustic_grand_piano', // or 1 (default)\n *   instruments: [ 'acoustic_grand_piano', 'acoustic_guitar_nylon' ] // or multiple instruments\n * })\n */\n\nroot.loadPlugin = function (opts) {\n  if (typeof opts === 'function') {\n    opts = { onsuccess: opts };\n  }\n\n  root.soundfontUrl = opts.soundfontUrl || root.soundfontUrl;\n\n  // / Detect the best type of audio to use\n  audioDetect(function (supports) {\n    const { hash } = window.location;\n    let api = '';\n\n    // / use the most appropriate plugin if not specified\n    if (supports[opts.api]) {\n      api = opts.api;\n    } else if (supports[hash.substr(1)]) {\n      api = hash.substr(1);\n    } else if (supports.webmidi) {\n      api = 'webmidi';\n    } else if (window.AudioContext) {\n      // Chrome\n      api = 'webaudio';\n    } else if (window.Audio) {\n      // Firefox\n      api = 'audiotag';\n    }\n\n    if (connect[api]) {\n      // / use audio/ogg when supported\n      let audioFormat;\n      if (opts.targetFormat) {\n        audioFormat = opts.targetFormat;\n      } else {\n        // use best quality\n        audioFormat = supports['audio/ogg'] ? 'ogg' : 'mp3';\n      }\n\n      // / load the specified plugin\n      root.__api = api;\n      root.__audioFormat = audioFormat;\n      root.supports = supports;\n      root.loadResource(opts);\n    }\n  });\n};\n\n/*\n *root.loadResource({\n *  onsuccess: function() { },\n *  onprogress: function(state, percent) { },\n *  instrument: 'banjo'\n *})\n */\n\nroot.loadResource = function (opts) {\n  let instruments =\n    opts.instruments || opts.instrument || 'acoustic_grand_piano';\n  // /\n  if (typeof instruments !== 'object') {\n    if (instruments || instruments === 0) {\n      instruments = [instruments];\n    } else {\n      instruments = [];\n    }\n  }\n  // / convert numeric ids into strings\n  for (let i = 0; i < instruments.length; i++) {\n    const instrument = instruments[i];\n    if (instrument === +instrument) {\n      // is numeric\n      if (root.GM.byId[instrument]) {\n        instruments[i] = root.GM.byId[instrument].id;\n      }\n    }\n  }\n  // /\n  opts.format = root.__audioFormat;\n  opts.instruments = instruments;\n  // /\n  connect[root.__api](opts);\n};\n\nvar connect = {\n  webmidi(opts) {\n    // cant wait for this to be standardized!\n    root.WebMIDI.connect(opts);\n  },\n  audiotag(opts) {\n    /*\n     * works ok, kinda like a drunken tuna fish, across the board\n     * http://caniuse.com/audio\n     */\n    requestQueue(opts, 'AudioTag');\n  },\n  webaudio(opts) {\n    /*\n     * works awesome! safari, chrome and firefox support\n     * http://caniuse.com/web-audio\n     */\n    requestQueue(opts, 'WebAudio');\n  },\n};\n\nvar requestQueue = function (opts, context) {\n  const audioFormat = opts.format;\n  const { instruments } = opts;\n  const { onprogress } = opts;\n  const { onerror } = opts;\n  // /\n  const { length } = instruments;\n  let pending = length;\n  const waitForEnd = function () {\n    if (!--pending) {\n      onprogress && onprogress('load', 1.0);\n      root[context].connect(opts);\n    }\n  };\n  // /\n  for (let i = 0; i < length; i++) {\n    var instrumentId = instruments[i];\n    if (root.Soundfont[instrumentId]) {\n      // already loaded\n      waitForEnd();\n    } else {\n      // needs to be requested\n      sendRequest(\n        instruments[i],\n        audioFormat,\n        function (evt, progress) {\n          const fileProgress = progress / length;\n          const queueProgress = (length - pending) / length;\n          onprogress &&\n            onprogress('load', fileProgress + queueProgress, instrumentId);\n        },\n        function () {\n          waitForEnd();\n        },\n        onerror\n      );\n    }\n  }\n};\n\nvar sendRequest = function (\n  instrumentId,\n  audioFormat,\n  onprogress,\n  onsuccess,\n  onerror\n) {\n  const soundfontPath = `${root.soundfontUrl + instrumentId}-${audioFormat}.js`;\n  if (root.USE_XHR) {\n    request({\n      url: soundfontPath,\n      format: 'text',\n      onerror,\n      onprogress,\n      onsuccess(event, responseText) {\n        const script = document.createElement('script');\n        script.language = 'javascript';\n        script.type = 'text/javascript';\n        script.text = responseText;\n        document.body.appendChild(script);\n        onsuccess();\n      },\n    });\n  } else {\n    loadScript.add({\n      url: soundfontPath,\n      verify: `root.Soundfont[\"${instrumentId}\"]`,\n      onerror,\n      onsuccess() {\n        onsuccess();\n      },\n    });\n  }\n};\n\nroot.setDefaultPlugin = function (midi) {\n  for (const key in midi) {\n    root[key] = midi[key];\n  }\n};\n","/*\n *----------------------------------------------------------\n *midi.Player : 0.3.1 : 2015-03-26\n *----------------------------------------------------------\n *https://github.com/mudcube/midi.js\n *----------------------------------------------------------\n */\n\nimport { MidiFile, Replayer } from './jasmid';\nimport root from './root';\n\n(function () {\n  root.Player = {};\n  const player = root.Player;\n  player.currentTime = 0;\n  player.endTime = 0;\n  player.restart = 0;\n  player.playing = false;\n  player.timeWarp = 1;\n  player.startDelay = 0;\n  player.BPM = 120;\n\n  player.start = player.resume = function (onsuccess) {\n    if (player.currentTime < -1) {\n      player.currentTime = -1;\n    }\n    startAudio(player.currentTime, null, onsuccess);\n  };\n\n  player.pause = function () {\n    const tmp = player.restart;\n    stopAudio();\n    player.restart = tmp;\n  };\n\n  player.stop = function () {\n    stopAudio();\n    player.restart = 0;\n    player.currentTime = 0;\n  };\n\n  player.addListener = function (onsuccess) {\n    onMidiEvent = onsuccess;\n  };\n\n  player.removeListener = function () {\n    onMidiEvent = undefined;\n  };\n\n  player.clearAnimation = function () {\n    if (player.animationFrameId) {\n      window.cancelAnimationFrame(player.animationFrameId);\n    }\n  };\n\n  player.setAnimation = function (callback) {\n    let currentTime = 0;\n    let tOurTime = 0;\n    let tTheirTime = 0;\n    //\n    player.clearAnimation();\n    // /\n    var frame = function () {\n      player.animationFrameId = window.requestAnimationFrame(frame);\n      // /\n      if (player.endTime === 0) {\n        return;\n      }\n      if (player.playing) {\n        currentTime =\n          tTheirTime === player.currentTime ? tOurTime - Date.now() : 0;\n        if (player.currentTime === 0) {\n          currentTime = 0;\n        } else {\n          currentTime = player.currentTime - currentTime;\n        }\n        if (tTheirTime !== player.currentTime) {\n          tOurTime = Date.now();\n          tTheirTime = player.currentTime;\n        }\n      } else {\n        // paused\n        currentTime = player.currentTime;\n      }\n      // /\n      const { endTime } = player;\n      // var percent = currentTime / endTime\n      const total = currentTime / 1000;\n      const minutes = total / 60;\n      const seconds = total - minutes * 60;\n      const t1 = minutes * 60 + seconds;\n      const t2 = endTime / 1000;\n      // /\n      if (t2 - t1 < -1.0) {\n      } else {\n        callback({\n          now: t1,\n          end: t2,\n          events: noteRegistrar,\n        });\n      }\n    };\n    // /\n    window.requestAnimationFrame(frame);\n  };\n\n  // helpers\n\n  player.loadMidiFile = function (onsuccess, onprogress, onerror) {\n    try {\n      // console.log(MidiFile(player.currentData), new Replayer(MidiFile(player.currentData), player.timeWarp, null, player.BPM))\n      player.replayer = new Replayer(\n        MidiFile(player.currentData),\n        player.timeWarp,\n        null,\n        player.BPM\n      );\n      player.data = player.replayer.getData();\n      player.endTime = getLength();\n      // /\n      root.loadPlugin({\n        // instruments: player.getFileInstruments(),\n        onsuccess,\n        onprogress,\n        onerror,\n      });\n    } catch (event) {\n      console.error(event);\n      onerror && onerror(event);\n    }\n  };\n\n  player.loadFile = function (file, onsuccess, onprogress, onerror) {\n    player.stop();\n    if (file.indexOf('base64,') !== -1) {\n      const data = window.atob(file.split(',')[1]);\n      player.currentData = data;\n      player.loadMidiFile(onsuccess, onprogress, onerror);\n    } else {\n      const fetch = new window.XMLHttpRequest();\n      fetch.open('GET', file);\n      fetch.overrideMimeType('text/plain; charset=x-user-defined');\n      fetch.onreadystatechange = function () {\n        if (this.readyState === 4) {\n          if (this.status === 200) {\n            const t = this.responseText || '';\n            const ff = [];\n            const mx = t.length;\n            const scc = String.fromCharCode;\n            for (let z = 0; z < mx; z++) {\n              ff[z] = scc(t.charCodeAt(z) & 255);\n            }\n            // /\n            const data = ff.join('');\n            player.currentData = data;\n            player.loadMidiFile(onsuccess, onprogress, onerror);\n          } else {\n            onerror && onerror('Unable to load MIDI file');\n          }\n        }\n      };\n      fetch.send();\n    }\n  };\n\n  player.getFileInstruments = function () {\n    const instruments = {};\n    const programs = {};\n    for (let n = 0; n < player.data.length; n++) {\n      const { event } = player.data[n][0];\n      if (event.type !== 'channel') {\n        continue;\n      }\n      const { channel } = event;\n      switch (event.subtype) {\n        case 'controller':\n          //        console.log(event.channel, root.defineControl[event.controllerType], event.value)\n          break;\n        case 'programChange':\n          programs[channel] = event.programNumber;\n          break;\n        case 'noteOn':\n          var program = programs[channel];\n          var gm = root.GM.byId[isFinite(program) ? program : channel];\n          instruments[gm.id] = true;\n          break;\n      }\n    }\n    const ret = [];\n    for (const key in instruments) {\n      ret.push(key);\n    }\n    return ret;\n  };\n\n  // Playing the audio\n\n  const eventQueue = []; // hold events to be triggered\n  let queuedTime; //\n  let startTime = 0; // to measure time elapse\n  var noteRegistrar = {}; // get event for requested note\n  let onMidiEvent; // listener\n  const scheduleTracking = function (\n    channel,\n    note,\n    currentTime,\n    offset,\n    message,\n    velocity,\n    time\n  ) {\n    return setTimeout(function () {\n      const data = {\n        channel,\n        note,\n        now: currentTime,\n        end: player.endTime,\n        message,\n        velocity,\n      };\n      //\n      if (message === 128) {\n        delete noteRegistrar[note];\n      } else {\n        noteRegistrar[note] = data;\n      }\n      if (onMidiEvent) {\n        onMidiEvent(data);\n      }\n      player.currentTime = currentTime;\n      // /\n      eventQueue.shift();\n      // /\n      if (eventQueue.length < 1000) {\n        startAudio(queuedTime, true);\n      } else if (\n        player.currentTime === queuedTime &&\n        queuedTime < player.endTime\n      ) {\n        // grab next sequence\n        startAudio(queuedTime, true);\n      }\n    }, currentTime - offset);\n  };\n\n  const getContext = function () {\n    if (root.api === 'webaudio') {\n      return root.WebAudio.getContext();\n    }\n    player.ctx = { currentTime: 0 };\n\n    return player.ctx;\n  };\n\n  var getLength = function () {\n    const { data } = player;\n    const { length } = data;\n    let totalTime = 0.5;\n    for (let n = 0; n < length; n++) {\n      totalTime += data[n][1];\n    }\n    return totalTime;\n  };\n\n  let __now;\n  const getNow = function () {\n    if (window.performance && window.performance.now) {\n      return window.performance.now();\n    }\n    return Date.now();\n  };\n\n  var startAudio = function (currentTime, fromCache, onsuccess) {\n    if (!player.replayer) {\n      return;\n    }\n    if (!fromCache) {\n      if (typeof currentTime === 'undefined') {\n        currentTime = player.restart;\n      }\n      // /\n      player.playing && stopAudio();\n      player.playing = true;\n      player.data = player.replayer.getData();\n      player.endTime = getLength();\n    }\n    // /\n    let note;\n    let offset = 0;\n    let messages = 0;\n    const { data } = player;\n    const ctx = getContext();\n    const { length } = data;\n    //\n    queuedTime = 0.5;\n    // /\n    // var interval = eventQueue[0] && eventQueue[0].interval || 0\n    const foffset = currentTime - player.currentTime;\n    // /\n    if (root.api !== 'webaudio') {\n      // set currentTime on ctx\n      const now = getNow();\n      __now = __now || now;\n      ctx.currentTime = (now - __now) / 1000;\n    }\n    // /\n    startTime = ctx.currentTime;\n    // /\n    for (let n = 0; n < length && messages < 100; n++) {\n      const obj = data[n];\n      if ((queuedTime += obj[1]) <= currentTime) {\n        offset = queuedTime;\n        continue;\n      }\n      // /\n      currentTime = queuedTime - offset;\n      // /\n      const { event } = obj[0];\n      if (event.type !== 'channel') {\n        continue;\n      }\n      // /\n      const channelId = event.channel;\n      const channel = root.channels[channelId];\n      const delay =\n        ctx.currentTime + (currentTime + foffset + player.startDelay) / 1000;\n      const queueTime = queuedTime - offset + player.startDelay;\n      switch (event.subtype) {\n        case 'controller':\n          root.setController(\n            channelId,\n            event.controllerType,\n            event.value,\n            delay\n          );\n          break;\n        case 'programChange':\n          root.programChange(channelId, event.programNumber, delay);\n          break;\n        case 'pitchBend':\n          root.pitchBend(channelId, event.value, delay);\n          break;\n        case 'noteOn':\n          if (channel.mute) break;\n          note = event.noteNumber - (player.MIDIOffset || 0);\n          eventQueue.push({\n            event,\n            time: queueTime,\n            source: root.noteOn(\n              channelId,\n              event.noteNumber,\n              event.velocity,\n              delay\n            ),\n            interval: scheduleTracking(\n              channelId,\n              note,\n              queuedTime + player.startDelay,\n              offset - foffset,\n              144,\n              event.velocity\n            ),\n          });\n          messages++;\n          break;\n        case 'noteOff':\n          if (channel.mute) break;\n          note = event.noteNumber - (player.MIDIOffset || 0);\n          eventQueue.push({\n            event,\n            time: queueTime,\n            source: root.noteOff(channelId, event.noteNumber, delay),\n            interval: scheduleTracking(\n              channelId,\n              note,\n              queuedTime,\n              offset - foffset,\n              128,\n              0\n            ),\n          });\n          break;\n        default:\n          break;\n      }\n    }\n    // /\n    onsuccess && onsuccess(eventQueue);\n  };\n\n  var stopAudio = function () {\n    const ctx = getContext();\n    player.playing = false;\n    player.restart += (ctx.currentTime - startTime) * 1000;\n    // stop the audio, and intervals\n    while (eventQueue.length) {\n      const o = eventQueue.pop();\n      window.clearInterval(o.interval);\n      if (!o.source) continue; // is not webaudio\n      if (typeof o.source === 'number') {\n        window.clearTimeout(o.source);\n      } else {\n        // webaudio\n        o.source.disconnect(0);\n      }\n    }\n    // run callback to cancel any notes still playing\n    for (const key in noteRegistrar) {\n      const o = noteRegistrar[key];\n      if (noteRegistrar[key].message === 144 && onMidiEvent) {\n        onMidiEvent({\n          channel: o.channel,\n          note: o.note,\n          now: o.now,\n          end: o.end,\n          message: 128,\n          velocity: o.velocity,\n        });\n      }\n    }\n    // reset noteRegistrar\n    noteRegistrar = {};\n  };\n})();\n","/*\n * ----------------------------------------------------------------------\n * AudioTag <audio> - OGG or MPEG Soundbank\n * ----------------------------------------------------------------------\n * http://dev.w3.org/html5/spec/Overview.html#the-audio-element\n * ----------------------------------------------------------------------\n */\nimport root from '../root';\n\nwindow.Audio &&\n  (function () {\n    const midi = (root.AudioTag = { api: 'audiotag' });\n    const noteToKey = {};\n    let volume = 127; // floating point\n    let bufferNid = -1; // current channel\n    const audioBuffers = []; // the audio channels\n    const notesOn = []; // instrumentId + noteId that is currently playing in each 'channel', for routing noteOff/chordOff calls\n    const notes = {}; // the piano keys\n    for (let nid = 0; nid < 12; nid++) {\n      audioBuffers[nid] = new window.Audio();\n    }\n\n    const playChannel = function (channel, note) {\n      if (!root.channels[channel]) return;\n      const { instrument } = root.channels[channel];\n      const instrumentId = root.GM.byId[instrument].id;\n      note = notes[note];\n      if (note) {\n        const instrumentNoteId = `${instrumentId}${note.id}`;\n        const nid = (bufferNid + 1) % audioBuffers.length;\n        const audio = audioBuffers[nid];\n        notesOn[nid] = instrumentNoteId;\n        if (!root.Soundfont[instrumentId]) {\n          if (root.DEBUG) {\n            console.log('404', instrumentId);\n          }\n          return;\n        }\n        audio.src = root.Soundfont[instrumentId][note.id];\n        audio.volume = volume / 127;\n        audio.play();\n        bufferNid = nid;\n      }\n    };\n\n    const stopChannel = function (channel, note) {\n      if (!root.channels[channel]) return;\n      const { instrument } = root.channels[channel];\n      const instrumentId = root.GM.byId[instrument].id;\n      note = notes[note];\n      if (note) {\n        const instrumentNoteId = `${instrumentId}${note.id}`;\n        for (let i = 0, len = audioBuffers.length; i < len; i++) {\n          const nid = (i + bufferNid + 1) % len;\n          const cId = notesOn[nid];\n          if (cId && cId === instrumentNoteId) {\n            audioBuffers[nid].pause();\n            notesOn[nid] = null;\n            return;\n          }\n        }\n      }\n    };\n\n    midi.audioBuffers = audioBuffers;\n    midi.send = function (data, delay) {};\n    midi.setController = function (channel, type, value, delay) {};\n    midi.setVolume = function (channel, n) {\n      volume = n; // - should be channel specific volume\n    };\n\n    midi.programChange = function (channel, program) {\n      root.channels[channel].instrument = program;\n    };\n\n    midi.pitchBend = function (channel, program, delay) {};\n\n    midi.noteOn = function (channel, note, velocity, delay) {\n      const id = noteToKey[note];\n      if (!notes[id]) return;\n      if (delay) {\n        return setTimeout(function () {\n          playChannel(channel, id);\n        }, delay * 1000);\n      }\n      playChannel(channel, id);\n    };\n\n    midi.noteOff = function (channel, note, delay) {\n      /*\n       *      var id = noteToKey[note]\n       *      if (!notes[id]) return\n       *      if (delay) {\n       *        return setTimeout(function() {\n       *          stopChannel(channel, id)\n       *        }, delay * 1000)\n       *      } else {\n       *        stopChannel(channel, id)\n       *      }\n       */\n    };\n\n    midi.chordOn = function (channel, chord, velocity, delay) {\n      for (let idx = 0; idx < chord.length; idx++) {\n        const n = chord[idx];\n        var id = noteToKey[n];\n        if (!notes[id]) continue;\n        if (delay) {\n          return setTimeout(function () {\n            playChannel(channel, id);\n          }, delay * 1000);\n        }\n        playChannel(channel, id);\n      }\n    };\n\n    midi.chordOff = function (channel, chord, delay) {\n      for (let idx = 0; idx < chord.length; idx++) {\n        const n = chord[idx];\n        var id = noteToKey[n];\n        if (!notes[id]) continue;\n        if (delay) {\n          return setTimeout(function () {\n            stopChannel(channel, id);\n          }, delay * 1000);\n        }\n        stopChannel(channel, id);\n      }\n    };\n\n    midi.stopAllNotes = function () {\n      for (let nid = 0, { length } = audioBuffers; nid < length; nid++) {\n        audioBuffers[nid].pause();\n      }\n    };\n\n    midi.connect = function (opts) {\n      root.setDefaultPlugin(midi);\n      // /\n      for (const key in root.keyToNote) {\n        noteToKey[root.keyToNote[key]] = key;\n        notes[key] = { id: key };\n      }\n      // /\n      opts.onsuccess && opts.onsuccess();\n    };\n  })();\n","import './audiotag';\nimport './webaudio';\nimport './webmidi';\n","/*\n * ----------------------------------------------------------\n * Web Audio API - OGG or MPEG Soundbank\n * ----------------------------------------------------------\n * http://webaudio.github.io/web-audio-api/\n * ----------------------------------------------------------\n */\nimport root from '../root';\n\n// REF: http://stackoverflow.com/questions/21797299/convert-base64-string-to-arraybuffer\nfunction base64ToArrayBuffer(base64) {\n  const binaryString = window.atob(base64);\n  const len = binaryString.length;\n  const bytes = new Uint8Array(len);\n  for (let i = 0; i < len; i++) {\n    bytes[i] = binaryString.charCodeAt(i);\n  }\n  return bytes.buffer;\n}\n\nwindow.AudioContext &&\n  (function () {\n    // var audioContext = null // new AudioContext()\n    const useStreamingBuffer = false; // !!audioContext.createMediaElementSource\n    const midi = (root.WebAudio = { api: 'webaudio' });\n    let ctx; // audio context\n    const sources = {};\n    const effects = {};\n    let masterVolume = 127;\n    const audioBuffers = {};\n    // /\n    midi.audioBuffers = audioBuffers;\n    midi.send = function (data, delay) {};\n    midi.setController = function (channelId, type, value, delay) {};\n\n    midi.setVolume = function (channelId, volume, delay) {\n      if (delay) {\n        setTimeout(function () {\n          masterVolume = volume;\n        }, delay * 1000);\n      } else {\n        masterVolume = volume;\n      }\n    };\n\n    midi.programChange = function (channelId, program, delay) {\n      /*\n       *      if (delay) {\n       *        return setTimeout(function() {\n       *          var channel = root.channels[channelId]\n       *          channel.instrument = program\n       *        }, delay)\n       *      } else {\n       */\n      const channel = root.channels[channelId];\n      channel.instrument = program;\n      //      }\n    };\n\n    midi.pitchBend = function (channelId, program, delay) {\n      /*\n       *      if (delay) {\n       *        setTimeout(function() {\n       *          var channel = root.channels[channelId]\n       *          channel.pitchBend = program\n       *        }, delay)\n       *      } else {\n       */\n      const channel = root.channels[channelId];\n      channel.pitchBend = program;\n      //      }\n    };\n\n    midi.noteOn = function (channelId, noteId, velocity, delay) {\n      delay = delay || 0;\n\n      // / check whether the note exists\n      const channel = root.channels[channelId];\n      const { instrument } = channel;\n      const bufferId = `${instrument}${noteId}`;\n      const buffer = audioBuffers[bufferId];\n      if (!buffer) {\n        //        console.log(midi.GM.byId[instrument].id, instrument, channelId)\n        return;\n      }\n\n      // / convert relative delay to absolute delay\n      if (delay < ctx.currentTime) {\n        delay += ctx.currentTime;\n      }\n\n      // / create audio buffer\n      let source;\n      if (useStreamingBuffer) {\n        source = ctx.createMediaElementSource(buffer);\n      } else {\n        // XMLHTTP buffer\n        source = ctx.createBufferSource();\n        source.buffer = buffer;\n      }\n\n      // / add effects to buffer\n      if (effects) {\n        let chain = source;\n        for (const key in effects) {\n          chain.connect(effects[key].input);\n          chain = effects[key];\n        }\n      }\n\n      // / add gain + pitchShift\n      const gain = (velocity / 127) * (masterVolume / 127) * 2 - 1;\n      source.connect(ctx.destination);\n      source.playbackRate.value = 1; // pitch shift\n      source.gainNode = ctx.createGain(); // gain\n      source.gainNode.connect(ctx.destination);\n      source.gainNode.gain.value = Math.min(1.0, Math.max(-1.0, gain));\n      source.connect(source.gainNode);\n      // /\n      if (useStreamingBuffer) {\n        if (delay) {\n          return setTimeout(function () {\n            buffer.currentTime = 0;\n            buffer.play();\n          }, delay * 1000);\n        }\n        buffer.currentTime = 0;\n        buffer.play();\n      } else {\n        source.start(delay || 0);\n      }\n      // /\n      sources[`${channelId}${noteId}`] = source;\n      // /\n      return source;\n    };\n\n    midi.noteOff = function (channelId, noteId, delay) {\n      delay = delay || 0;\n\n      // / check whether the note exists\n      const channel = root.channels[channelId];\n      const { instrument } = channel;\n      const bufferId = `${instrument}${noteId}`;\n      const buffer = audioBuffers[bufferId];\n      if (buffer) {\n        if (delay < ctx.currentTime) {\n          delay += ctx.currentTime;\n        }\n        // /\n        const source = sources[`${channelId}${noteId}`];\n        if (source) {\n          if (source.gainNode) {\n            /*\n             * @Miranet: 'the values of 0.2 and 0.3 could of course be used as\n             * a 'release' parameter for ADSR like time settings.'\n             * add { 'metadata': { release: 0.3 } } to soundfont files\n             */\n            const { gain } = source.gainNode;\n            gain.linearRampToValueAtTime(gain.value, delay);\n            gain.linearRampToValueAtTime(-1.0, delay + 0.3);\n          }\n          // /\n          if (useStreamingBuffer) {\n            if (delay) {\n              setTimeout(function () {\n                buffer.pause();\n              }, delay * 1000);\n            } else {\n              buffer.pause();\n            }\n          } else if (source.noteOff) {\n            source.noteOff(delay + 0.5);\n          } else {\n            source.stop(delay + 0.5);\n          }\n          // /\n          delete sources[`${channelId}${noteId}`];\n          // /\n          return source;\n        }\n      }\n    };\n\n    midi.chordOn = function (channel, chord, velocity, delay) {\n      const res = {};\n      for (var n = 0, note, len = chord.length; n < len; n++) {\n        res[(note = chord[n])] = midi.noteOn(channel, note, velocity, delay);\n      }\n      return res;\n    };\n\n    midi.chordOff = function (channel, chord, delay) {\n      const res = {};\n      for (var n = 0, note, len = chord.length; n < len; n++) {\n        res[(note = chord[n])] = midi.noteOff(channel, note, delay);\n      }\n      return res;\n    };\n\n    midi.stopAllNotes = function () {\n      for (const sid in sources) {\n        let delay = 0;\n        if (delay < ctx.currentTime) {\n          delay += ctx.currentTime;\n        }\n        const source = sources[sid];\n        source.gain.linearRampToValueAtTime(1, delay);\n        source.gain.linearRampToValueAtTime(0, delay + 0.3);\n        if (source.noteOff) {\n          // old api\n          source.noteOff(delay + 0.3);\n        } else {\n          // new api\n          source.stop(delay + 0.3);\n        }\n        delete sources[sid];\n      }\n    };\n\n    midi.setEffects = function (list) {\n      if (ctx.tunajs) {\n        for (let n = 0; n < list.length; n++) {\n          const data = list[n];\n          const effect = new ctx.tunajs[data.type](data);\n          effect.connect(ctx.destination);\n          effects[data.type] = effect;\n        }\n      } else {\n        return console.log('Effects module not installed.');\n      }\n    };\n\n    midi.connect = function (opts) {\n      root.setDefaultPlugin(midi);\n      midi.setContext(ctx || createAudioContext(), opts.onsuccess);\n    };\n\n    midi.getContext = function () {\n      return ctx;\n    };\n\n    midi.setContext = function (newCtx, onload, onprogress, onerror) {\n      ctx = newCtx;\n\n      // / tuna.js effects module - https://github.com/Dinahmoe/tuna\n      if (typeof window.Tuna !== 'undefined' && !ctx.tunajs) {\n        ctx.tunajs = new window.Tuna(ctx);\n      }\n\n      // / loading audio files\n      const urls = [];\n      const notes = root.keyToNote;\n      for (const key in notes) urls.push(key);\n      // /\n      const waitForEnd = function (instrument) {\n        for (const key in bufferPending) {\n          // has pending items\n          if (bufferPending[key]) return;\n        }\n        // /\n        if (onload) {\n          // run onload once\n          onload();\n          onload = null;\n        }\n      };\n      // /\n      const requestAudio = function (soundfont, instrumentId, index, key) {\n        const url = soundfont[key];\n        if (url) {\n          bufferPending[instrumentId]++;\n          loadAudio(\n            url,\n            function (buffer) {\n              buffer.id = key;\n              const noteId = root.keyToNote[key];\n              audioBuffers[`${instrumentId}${noteId}`] = buffer;\n              // /\n              if (--bufferPending[instrumentId] === 0) {\n                /*\n                 * var percent = index / 87\n                 *              console.log(midi.GM.byId[instrumentId], 'processing: ', percent)\n                 */\n                soundfont.isLoaded = true;\n                waitForEnd(instrument);\n              }\n            },\n            function (err) {\n              console.error(err);\n            }\n          );\n        }\n      };\n      // /\n      var bufferPending = {};\n      for (var instrument in root.Soundfont) {\n        const soundfont = root.Soundfont[instrument];\n        if (soundfont.isLoaded) {\n          continue;\n        }\n        // /\n        const synth = root.GM.byName[instrument];\n        const instrumentId = synth.number;\n        // /\n        bufferPending[instrumentId] = 0;\n        // /\n        for (let index = 0; index < urls.length; index++) {\n          const key = urls[index];\n          requestAudio(soundfont, instrumentId, index, key);\n        }\n      }\n      // /\n      setTimeout(waitForEnd, 1);\n    };\n\n    /*\n     * Load audio file: streaming | base64 | arraybuffer\n     * ----------------------------------------------------------------------\n     */\n    function loadAudio(url, onload, onerror) {\n      if (useStreamingBuffer) {\n        const audio = new window.Audio();\n        audio.src = url;\n        audio.controls = false;\n        audio.autoplay = false;\n        audio.preload = false;\n        audio.addEventListener('canplay', function () {\n          onload && onload(audio);\n        });\n        audio.addEventListener('error', function (err) {\n          onerror && onerror(err);\n        });\n        document.body.appendChild(audio);\n      } else if (url.indexOf('data:audio') === 0) {\n        // Base64 string\n        const base64 = url.split(',')[1];\n        const buffer = base64ToArrayBuffer(base64);\n        ctx.decodeAudioData(buffer, onload, onerror);\n      } else {\n        // XMLHTTP buffer\n        const request = new window.XMLHttpRequest();\n        request.open('GET', url, true);\n        request.responseType = 'arraybuffer';\n        request.onload = function () {\n          ctx.decodeAudioData(request.response, onload, onerror);\n        };\n        request.send();\n      }\n    }\n\n    function createAudioContext() {\n      return new (window.AudioContext || window.webkitAudioContext)();\n    }\n  })();\n","/*\n * ----------------------------------------------------------------------\n * Web MIDI API - Native Soundbanks\n * ----------------------------------------------------------------------\n * http://webaudio.github.io/web-midi-api/\n * ----------------------------------------------------------------------\n */\nimport root from '../root';\n\n(function () {\n  let plugin = null;\n  let output = null;\n  const midi = (root.WebMIDI = { api: 'webmidi' });\n  midi.send = function (data, delay) {\n    // set channel volume\n    output.send(data, delay * 1000);\n  };\n\n  midi.setController = function (channel, type, value, delay) {\n    output.send([channel, type, value], delay * 1000);\n  };\n\n  midi.setVolume = function (channel, volume, delay) {\n    // set channel volume\n    output.send([0xb0 + channel, 0x07, volume], delay * 1000);\n  };\n\n  midi.programChange = function (channel, program, delay) {\n    // change patch (instrument)\n    output.send([0xc0 + channel, program], delay * 1000);\n  };\n\n  midi.pitchBend = function (channel, program, delay) {\n    // pitch bend\n    output.send([0xe0 + channel, program], delay * 1000);\n  };\n\n  midi.noteOn = function (channel, note, velocity, delay) {\n    output.send([0x90 + channel, note, velocity], delay * 1000);\n  };\n\n  midi.noteOff = function (channel, note, delay) {\n    output.send([0x80 + channel, note, 0], delay * 1000);\n  };\n\n  midi.chordOn = function (channel, chord, velocity, delay) {\n    for (let n = 0; n < chord.length; n++) {\n      const note = chord[n];\n      output.send([0x90 + channel, note, velocity], delay * 1000);\n    }\n  };\n\n  midi.chordOff = function (channel, chord, delay) {\n    for (let n = 0; n < chord.length; n++) {\n      const note = chord[n];\n      output.send([0x80 + channel, note, 0], delay * 1000);\n    }\n  };\n\n  midi.stopAllNotes = function () {\n    output.cancel();\n    for (let channel = 0; channel < 16; channel++) {\n      output.send([0xb0 + channel, 0x7b, 0]);\n    }\n  };\n\n  midi.connect = function (opts) {\n    root.setDefaultPlugin(midi);\n    const errFunction = function (err) {\n      // well at least we tried!\n      if (window.AudioContext) {\n        // Chrome\n        opts.api = 'webaudio';\n      } else if (window.Audio) {\n        // Firefox\n        opts.api = 'audiotag';\n      } else {\n        // no support\n        return err;\n      }\n      root.loadPlugin(opts);\n    };\n    // /\n    navigator.requestMIDIAccess().then(function (access) {\n      plugin = access;\n      const pluginOutputs = plugin.outputs;\n      if (typeof pluginOutputs === 'function') {\n        // Chrome pre-43\n        output = pluginOutputs()[0];\n      } else {\n        // Chrome post-43\n        output = pluginOutputs[0];\n      }\n      if (output === undefined) {\n        // nothing there...\n        errFunction();\n      } else {\n        opts.onsuccess && opts.onsuccess();\n      }\n    }, errFunction);\n  };\n})();\n","module.exports = {};\n","/*\n *----------------------------------------------------------\n *midi.audioDetect : 0.3.2 : 2015-03-26\n *----------------------------------------------------------\n *https://github.com/mudcube/midi.js\n *----------------------------------------------------------\n *Probably, Maybe, No... Absolutely!\n *Test to see what types of <audio> MIME types are playable by the browser.\n *----------------------------------------------------------\n */\n\nconst supports = {}; // object of supported file types\nlet pending = 0; // pending file types to process\nconst canPlayThrough = function (src) {\n  // check whether format plays through\n  pending++;\n  const { body } = document;\n  const audio = new window.Audio();\n  const mime = src.split(';')[0];\n  audio.id = 'audio';\n  audio.setAttribute('preload', 'auto');\n  audio.setAttribute('audiobuffer', true);\n  audio.addEventListener(\n    'error',\n    function () {\n      body.removeChild(audio);\n      supports[mime] = false;\n      pending--;\n    },\n    false\n  );\n  audio.addEventListener(\n    'canplaythrough',\n    function () {\n      body.removeChild(audio);\n      supports[mime] = true;\n      pending--;\n    },\n    false\n  );\n  audio.src = `data:${src}`;\n  body.appendChild(audio);\n};\n\nexport const audioDetect = function (onsuccess) {\n  // / detect jazz-midi plugin\n  if (navigator.requestMIDIAccess) {\n    const isNative = Function.prototype.toString\n      .call(navigator.requestMIDIAccess)\n      .indexOf('[native code]');\n    if (isNative) {\n      // has native midiapi support\n      supports.webmidi = true;\n    } else {\n      // check for jazz plugin midiapi support\n      for (let n = 0; navigator.plugins.length > n; n++) {\n        const plugin = navigator.plugins[n];\n        if (plugin.name.indexOf('Jazz-Plugin') >= 0) {\n          supports.webmidi = true;\n        }\n      }\n    }\n  }\n\n  // / check whether <audio> tag is supported\n  if (typeof window.Audio === 'undefined') {\n    return onsuccess({});\n  }\n  supports.audiotag = true;\n\n  // / check for webaudio api support\n  if (window.AudioContext || window.webkitAudioContext) {\n    supports.webaudio = true;\n  }\n\n  // / check whether canPlayType is supported\n  const audio = new window.Audio();\n  if (typeof audio.canPlayType === 'undefined') {\n    return onsuccess(supports);\n  }\n\n  // / see what we can learn from the browser\n  let vorbis = audio.canPlayType('audio/ogg; codecs=\"vorbis\"');\n  vorbis = vorbis === 'probably' || vorbis === 'maybe';\n  let mpeg = audio.canPlayType('audio/mpeg');\n  mpeg = mpeg === 'probably' || mpeg === 'maybe';\n  // maybe nothing is supported\n  if (!vorbis && !mpeg) {\n    onsuccess(supports);\n    return;\n  }\n\n  // / or maybe something is supported\n  if (vorbis)\n    canPlayThrough(\n      'audio/ogg;base64,T2dnUwACAAAAAAAAAADqnjMlAAAAAOyyzPIBHgF2b3JiaXMAAAAAAUAfAABAHwAAQB8AAEAfAACZAU9nZ1MAAAAAAAAAAAAA6p4zJQEAAAANJGeqCj3//////////5ADdm9yYmlzLQAAAFhpcGguT3JnIGxpYlZvcmJpcyBJIDIwMTAxMTAxIChTY2hhdWZlbnVnZ2V0KQAAAAABBXZvcmJpcw9CQ1YBAAABAAxSFCElGVNKYwiVUlIpBR1jUFtHHWPUOUYhZBBTiEkZpXtPKpVYSsgRUlgpRR1TTFNJlVKWKUUdYxRTSCFT1jFloXMUS4ZJCSVsTa50FkvomWOWMUYdY85aSp1j1jFFHWNSUkmhcxg6ZiVkFDpGxehifDA6laJCKL7H3lLpLYWKW4q91xpT6y2EGEtpwQhhc+211dxKasUYY4wxxsXiUyiC0JBVAAABAABABAFCQ1YBAAoAAMJQDEVRgNCQVQBABgCAABRFcRTHcRxHkiTLAkJDVgEAQAAAAgAAKI7hKJIjSZJkWZZlWZameZaouaov+64u667t6roOhIasBACAAAAYRqF1TCqDEEPKQ4QUY9AzoxBDDEzGHGNONKQMMogzxZAyiFssLqgQBKEhKwKAKAAAwBjEGGIMOeekZFIi55iUTkoDnaPUUcoolRRLjBmlEluJMYLOUeooZZRCjKXFjFKJscRUAABAgAMAQICFUGjIigAgCgCAMAYphZRCjCnmFHOIMeUcgwwxxiBkzinoGJNOSuWck85JiRhjzjEHlXNOSuekctBJyaQTAAAQ4AAAEGAhFBqyIgCIEwAwSJKmWZomipamiaJniqrqiaKqWp5nmp5pqqpnmqpqqqrrmqrqypbnmaZnmqrqmaaqiqbquqaquq6nqrZsuqoum65q267s+rZru77uqapsm6or66bqyrrqyrbuurbtS56nqqKquq5nqq6ruq5uq65r25pqyq6purJtuq4tu7Js664s67pmqq5suqotm64s667s2rYqy7ovuq5uq7Ks+6os+75s67ru2rrwi65r66os674qy74x27bwy7ouHJMnqqqnqq7rmarrqq5r26rr2rqmmq5suq4tm6or26os67Yry7aumaosm64r26bryrIqy77vyrJui67r66Ys67oqy8Lu6roxzLat+6Lr6roqy7qvyrKuu7ru+7JuC7umqrpuyrKvm7Ks+7auC8us27oxuq7vq7It/KosC7+u+8Iy6z5jdF1fV21ZGFbZ9n3d95Vj1nVhWW1b+V1bZ7y+bgy7bvzKrQvLstq2scy6rSyvrxvDLux8W/iVmqratum6um7Ksq/Lui60dd1XRtf1fdW2fV+VZd+3hV9pG8OwjK6r+6os68Jry8ov67qw7MIvLKttK7+r68ow27qw3L6wLL/uC8uq277v6rrStXVluX2fsSu38QsAABhwAAAIMKEMFBqyIgCIEwBAEHIOKQahYgpCCKGkEEIqFWNSMuakZM5JKaWUFEpJrWJMSuaclMwxKaGUlkopqYRSWiqlxBRKaS2l1mJKqcVQSmulpNZKSa2llGJMrcUYMSYlc05K5pyUklJrJZXWMucoZQ5K6iCklEoqraTUYuacpA46Kx2E1EoqMZWUYgupxFZKaq2kFGMrMdXUWo4hpRhLSrGVlFptMdXWWqs1YkxK5pyUzDkqJaXWSiqtZc5J6iC01DkoqaTUYiopxco5SR2ElDLIqJSUWiupxBJSia20FGMpqcXUYq4pxRZDSS2WlFosqcTWYoy1tVRTJ6XFklKMJZUYW6y5ttZqDKXEVkqLsaSUW2sx1xZjjqGkFksrsZWUWmy15dhayzW1VGNKrdYWY40x5ZRrrT2n1mJNMdXaWqy51ZZbzLXnTkprpZQWS0oxttZijTHmHEppraQUWykpxtZara3FXEMpsZXSWiypxNhirLXFVmNqrcYWW62ltVprrb3GVlsurdXcYqw9tZRrrLXmWFNtBQAADDgAAASYUAYKDVkJAEQBAADGMMYYhEYpx5yT0ijlnHNSKucghJBS5hyEEFLKnINQSkuZcxBKSSmUklJqrYVSUmqttQIAAAocAAACbNCUWByg0JCVAEAqAIDBcTRNFFXVdX1fsSxRVFXXlW3jVyxNFFVVdm1b+DVRVFXXtW3bFn5NFFVVdmXZtoWiqrqybduybgvDqKqua9uybeuorqvbuq3bui9UXVmWbVu3dR3XtnXd9nVd+Bmzbeu2buu+8CMMR9/4IeTj+3RCCAAAT3AAACqwYXWEk6KxwEJDVgIAGQAAgDFKGYUYM0gxphhjTDHGmAAAgAEHAIAAE8pAoSErAoAoAADAOeecc84555xzzjnnnHPOOeecc44xxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY0wAwE6EA8BOhIVQaMhKACAcAABACCEpKaWUUkoRU85BSSmllFKqFIOMSkoppZRSpBR1lFJKKaWUIqWgpJJSSimllElJKaWUUkoppYw6SimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaVUSimllFJKKaWUUkoppRQAYPLgAACVYOMMK0lnhaPBhYasBAByAwAAhRiDEEJpraRUUkolVc5BKCWUlEpKKZWUUqqYgxBKKqmlklJKKbXSQSihlFBKKSWUUkooJYQQSgmhlFRCK6mEUkoHoYQSQimhhFRKKSWUzkEoIYUOQkmllNRCSB10VFIpIZVSSiklpZQ6CKGUklJLLZVSWkqpdBJSKamV1FJqqbWSUgmhpFZKSSWl0lpJJbUSSkklpZRSSymFVFJJJYSSUioltZZaSqm11lJIqZWUUkqppdRSSiWlkEpKqZSSUmollZRSaiGVlEpJKaTUSimlpFRCSamlUlpKLbWUSkmptFRSSaWUlEpJKaVSSksppRJKSqmllFpJKYWSUkoplZJSSyW1VEoKJaWUUkmptJRSSymVklIBAEAHDgAAAUZUWoidZlx5BI4oZJiAAgAAQABAgAkgMEBQMApBgDACAQAAAADAAAAfAABHARAR0ZzBAUKCwgJDg8MDAAAAAAAAAAAAAACAT2dnUwAEAAAAAAAAAADqnjMlAgAAADzQPmcBAQA='\n    );\n  if (mpeg)\n    canPlayThrough(\n      'audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq'\n    );\n\n  // / lets find out!\n  const time = new Date().getTime();\n  const interval = window.setInterval(function () {\n    const now = new Date().getTime();\n    const maxExecution = now - time > 5000;\n    if (!pending || maxExecution) {\n      window.clearInterval(interval);\n      onsuccess(supports);\n    }\n  }, 1);\n};\n","export * from './audio-detect';\nexport * from './load-script';\nexport * from './request';\n","/*\n * -----------------------------------------------------------\n * loadScript.js : 0.1.4 : 2014/02/12 : http://mudcu.be\n * -----------------------------------------------------------\n * Copyright 2011-2014 Mudcube. All rights reserved.\n * -----------------------------------------------------------\n * // No verification\n * loadScript.add(\"../js/jszip/jszip.js\")\n * // Strict loading order and verification.\n * loadScript.add({\n *   strictOrder: true,\n *   urls: [\n *     {\n *       url: \"../js/jszip/jszip.js\",\n *       verify: \"JSZip\",\n *       onsuccess: function() {\n *         console.log(1)\n *       }\n *     },\n *     {\n *       url: \"../inc/downloadify/js/swfobject.js\",\n *       verify: \"swfobject\",\n *       onsuccess: function() {\n *         console.log(2)\n *       }\n *     }\n *   ],\n *   onsuccess: function() {\n *     console.log(3)\n *   }\n * })\n * // Just verification.\n * loadScript.add({\n *   url: \"../js/jszip/jszip.js\",\n *   verify: \"JSZip\",\n *   onsuccess: function() {\n *     console.log(1)\n *   }\n * })\n */\n\nconst _globalExists = function (path, root) {\n  try {\n    path = path\n      .split('\"')\n      .join('')\n      .split(\"'\")\n      .join('')\n      .split(']')\n      .join('')\n      .split('[')\n      .join('.');\n    const parts = path.split('.');\n    const { length } = parts;\n    let object = root || window;\n    for (let n = 0; n < length; n++) {\n      const key = parts[n];\n      if (object[key] == null) {\n        return false;\n      }\n      //\n      object = object[key];\n    }\n    return true;\n  } catch (e) {\n    return false;\n  }\n};\n\nconst LoadScript = function () {\n  this.loaded = {};\n  this.loading = {};\n  return this;\n};\n\nLoadScript.prototype.add = function (config) {\n  const that = this;\n  if (typeof config === 'string') {\n    config = { url: config };\n  }\n  let { urls } = config;\n  if (typeof urls === 'undefined') {\n    urls = [\n      {\n        url: config.url,\n        verify: config.verify,\n      },\n    ];\n  }\n  // / adding the elements to the head\n  const doc = document.getElementsByTagName('head')[0];\n  // /\n  const testElement = function (element, test) {\n    if (that.loaded[element.url]) return;\n    if (test && _globalExists(test) === false) return;\n    that.loaded[element.url] = true;\n    //\n    if (that.loading[element.url]) that.loading[element.url]();\n    delete that.loading[element.url];\n    //\n    if (element.onsuccess) element.onsuccess();\n    if (typeof getNext !== 'undefined') getNext();\n  };\n  // /\n  let hasError = false;\n  let batchTest = [];\n  const addElement = function (element) {\n    if (typeof element === 'string') {\n      element = {\n        url: element,\n        verify: config.verify,\n      };\n    }\n    if (/([\\w\\d.\\[\\]'\"])$/.test(element.verify)) {\n      // check whether its a variable reference\n      const verify = (element.test = element.verify);\n      if (typeof verify === 'object') {\n        for (let n = 0; n < verify.length; n++) {\n          batchTest.push(verify[n]);\n        }\n      } else {\n        batchTest.push(verify);\n      }\n    }\n    if (that.loaded[element.url]) return;\n    const script = document.createElement('script');\n    script.onreadystatechange = function () {\n      if (this.readyState !== 'loaded' && this.readyState !== 'complete')\n        return;\n      testElement(element);\n    };\n    script.onload = function () {\n      testElement(element);\n    };\n    script.onerror = function () {\n      hasError = true;\n      delete that.loading[element.url];\n      if (typeof element.test === 'object') {\n        for (const key in element.test) {\n          removeTest(element.test[key]);\n        }\n      } else {\n        removeTest(element.test);\n      }\n    };\n    script.setAttribute('type', 'text/javascript');\n    script.setAttribute('src', element.url);\n    doc.appendChild(script);\n    that.loading[element.url] = function () {};\n  };\n  // / checking to see whether everything loaded properly\n  var removeTest = function (test) {\n    const ret = [];\n    for (let n = 0; n < batchTest.length; n++) {\n      if (batchTest[n] === test) continue;\n      ret.push(batchTest[n]);\n    }\n    batchTest = ret;\n  };\n  var onLoad = function (element) {\n    if (element) {\n      testElement(element, element.test);\n    } else {\n      for (let n = 0; n < urls.length; n++) {\n        testElement(urls[n], urls[n].test);\n      }\n    }\n    let istrue = true;\n    for (let n = 0; n < batchTest.length; n++) {\n      if (_globalExists(batchTest[n]) === false) {\n        istrue = false;\n      }\n    }\n    if (!config.strictOrder && istrue) {\n      // finished loading all the requested scripts\n      if (hasError) {\n        if (config.error) {\n          config.error();\n        }\n      } else if (config.onsuccess) {\n        config.onsuccess();\n      }\n    } else {\n      // keep calling back the function\n      setTimeout(function () {\n        // - should get slower over time?\n        onLoad(element);\n      }, 10);\n    }\n  };\n  // / loading methods;  strict ordering or loose ordering\n  if (config.strictOrder) {\n    let ID = -1;\n    var getNext = function () {\n      ID++;\n      if (!urls[ID]) {\n        // all elements are loaded\n        if (hasError) {\n          if (config.error) {\n            config.error();\n          }\n        } else if (config.onsuccess) {\n          config.onsuccess();\n        }\n      } else {\n        // loading new script\n        const element = urls[ID];\n        const { url } = element;\n        if (that.loading[url]) {\n          // already loading from another call (attach to event)\n          that.loading[url] = function () {\n            if (element.onsuccess) element.onsuccess();\n            getNext();\n          };\n        } else if (!that.loaded[url]) {\n          // create script element\n          addElement(element);\n          onLoad(element);\n        } else {\n          // it's already been successfully loaded\n          getNext();\n        }\n      }\n    };\n    getNext();\n  } else {\n    // loose ordering\n    for (let ID = 0; ID < urls.length; ID++) {\n      addElement(urls[ID]);\n      onLoad(urls[ID]);\n    }\n  }\n};\n\nexport const loadScript = new LoadScript();\n","/*\n * ----------------------------------------------------------\n * Request : 0.1.1 : 2015-03-26\n * ----------------------------------------------------------\n * request({\n *   url: './dir/something.extension',\n *   data: 'test!',\n *   format: 'text', // text | xml | json | binary\n *   responseType: 'text', // arraybuffer | blob | document | json | text\n *   headers: {},\n *   withCredentials: true, // true | false\n *\n *   onerror: function(evt, percent) {\n *     console.log(evt)\n *   },\n *   onsuccess: function(evt, responseText) {\n *     console.log(responseText)\n *   },\n *   onprogress: function(evt, percent) {\n *     percent = Math.round(percent * 100)\n *     loader.create('thread', 'loading... ', percent)\n *   }\n * })\n */\n\nexport function request(opts, onsuccess, onerror, onprogress) {\n  if (typeof opts === 'string') opts = { url: opts };\n  const { data } = opts;\n  const { url } = opts;\n  const method = opts.method || (opts.data ? 'POST' : 'GET');\n  const { format } = opts;\n  const { headers } = opts;\n  const { responseType } = opts;\n  const withCredentials = opts.withCredentials || false;\n  const xhr = new window.XMLHttpRequest();\n  onsuccess = onsuccess || opts.onsuccess;\n  onerror = onerror || opts.onerror;\n  onprogress = onprogress || opts.onprogress;\n  xhr.open(method, url, true);\n  if (headers) {\n    for (const type in headers) {\n      xhr.setRequestHeader(type, headers[type]);\n    }\n  } else if (data) {\n    // set the default headers for POST\n    xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n  }\n  if (format === 'binary') {\n    // - default to responseType=\"blob\" when supported\n    if (xhr.overrideMimeType) {\n      xhr.overrideMimeType('text/plain; charset=x-user-defined');\n    }\n  }\n  if (responseType) {\n    xhr.responseType = responseType;\n  }\n  if (withCredentials) {\n    xhr.withCredentials = 'true';\n  }\n  if (onerror && 'onerror' in xhr) {\n    xhr.onerror = onerror;\n  }\n  if (onprogress && xhr.upload && 'onprogress' in xhr.upload) {\n    if (data) {\n      xhr.upload.onprogress = function (evt) {\n        onprogress.call(xhr, evt, evt.loaded / evt.total);\n      };\n    } else {\n      xhr.addEventListener('progress', function (evt) {\n        let totalBytes = 0;\n        if (evt.lengthComputable) {\n          totalBytes = evt.total;\n        } else if (xhr.totalBytes) {\n          totalBytes = xhr.totalBytes;\n        } else {\n          const rawBytes = parseInt(\n            xhr.getResponseHeader('Content-Length-Raw')\n          );\n          if (isFinite(rawBytes)) {\n            xhr.totalBytes = totalBytes = rawBytes;\n          } else {\n            return;\n          }\n        }\n        onprogress.call(xhr, evt, evt.loaded / totalBytes);\n      });\n    }\n  }\n  // /\n  xhr.onreadystatechange = function (evt) {\n    if (xhr.readyState === 4) {\n      // The request is complete\n      if (\n        xhr.status === 200 || // Response OK\n        xhr.status === 304 || // Not Modified\n        xhr.status === 308 // Permanent Redirect\n      ) {\n        if (onsuccess) {\n          let res;\n          if (format === 'xml') {\n            res = evt.target.responseXML;\n          } else if (format === 'text') {\n            res = evt.target.responseText;\n          } else if (format === 'json') {\n            try {\n              res = JSON.parse(evt.target.response);\n            } catch (err) {\n              onerror && onerror.call(xhr, evt);\n            }\n          }\n          onsuccess.call(xhr, evt, res);\n        }\n      } else {\n        onerror && onerror.call(xhr, evt);\n      }\n    }\n  };\n  xhr.send(data);\n  return xhr;\n}\n"],"sourceRoot":""}